build:
  gpu: true
  python_version: "3.10" # Stable Python
  python_requirements: "requirements.txt"
  cuda: "12.1"
  
  # Remove all complex system packages and rely on Cog's default optimized base image for 3.10
  # This makes the build smaller and faster.
  # We will only keep 'run' for unsloth as a specialized package.
  
  run:
    # 1. Install bitsandbytes (needed for 4-bit) and trl first
    - pip install bitsandbytes==0.43.2 trl==0.9.4
    # 2. Install Unsloth
    - pip install unsloth[lora]==2024.9 
    
train: "train.py:train" 
predict: "predict.py:Predictor"

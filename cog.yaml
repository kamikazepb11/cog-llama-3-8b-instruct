build:
  gpu: true
  python_version: "3.10" # CHANGED to 3.10 for build stability and cached images
  python_requirements: "requirements.txt"
  cuda: "12.1"

  # System packages added to support compilation of Python (libssl) and scientific dependencies (libblas, liblapack, build-essential).
  system_packages:
    - "build-essential"   
    - "libssl-dev"        
    - "zlib1g-dev"        
    - "libbz2-dev"        
    - "libreadline-dev"   
    - "libsqlite3-dev"    
    - "libffi-dev"        
    - "liblzma-dev"       
    - "python3-dev"       
    - "tk-dev"            
    - "libncurses5-dev"   
    - "libgdbm-dev"       
    - "libc6-dev"         
    - "libblas-dev"       
    - "liblapack-dev"     
    - "git"
    - "curl"              

  # Manually install Unsloth (the complex library) to bypass the main pip install block and avoid metadata errors.
  run:
    - pip install unsloth[lora]==2024.9 
    
train: "train.py:train" 
predict: "predict.py:Predictor"
